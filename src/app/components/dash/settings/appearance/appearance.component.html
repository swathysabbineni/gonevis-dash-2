<!-- Media -->
<div class="row justify-content-center">
  <div class="col-xl-6">
    <div class="card dash mb-3">
      <!-- Header -->
      <div class="card-header" translate>MEDIA</div>
      <!-- Body -->
      <div class="card-body">
        <div class="row">
          <!-- Logo -->
          <div class="col-sm-6">
            <div class="media">
              <!-- Logo image -->
              <img class="mr-3 rounded" *ngIf="settings && settings.media.logo"
                   [src]="settings.media.logo.thumbnail_128x128" [width]="64">
              <div class="media-body">
                <h5 class="mt-0" translate>BLOG_LOGO</h5>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-sm btn-secondary" translate
                          (click)="showFileListModal(fileListModalTemplate, 'logo')">
                    SELECT
                  </button>
                  <!-- Delete logo-->
                  <button class="btn btn-sm btn-outline-secondary" *ngIf="settings && settings.media.logo"
                          (click)="submitSettings({ logo: null })">
                    <fa-icon [icon]="faTrash"></fa-icon>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <!-- Cover -->
          <div class="col-sm-6">
            <div class="media">
              <!-- Cover image -->
              <img class="mr-3 rounded" *ngIf="settings && settings.media.cover_image"
                   [src]="settings.media.cover_image.thumbnail_128x128" [width]="64">
              <div class="media-body">
                <h5 class="mt-0" translate>BLOG_COVER</h5>
                <div class="btn-group btn-group-sm">
                  <button class="btn btn-sm btn-secondary" translate
                          (click)="showFileListModal(fileListModalTemplate, 'cover_image')">
                    SELECT
                  </button>
                  <!-- Delete cover -->
                  <button class="btn btn-sm btn-outline-secondary" *ngIf="settings && settings.media.cover_image"
                          (click)="submitSettings({ cover_image: null })">
                    <fa-icon [icon]="faTrash"></fa-icon>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Theme -->
    <form class="card dash mb-3" [formGroup]="themeForm" (ngSubmit)="submitSettings()">
      <!-- Header -->
      <div class="card-header" translate>THEME</div>
      <!-- Body -->
      <div class="card-body" *ngIf="themeCarousel">
        <!-- Theme name -->
        {{ getThemeViewing().name | uppercase }}
        <!-- Theme buttons -->
        <div class="btn-group float-right">
          <!-- Preview -->
          <a class="btn btn-light" [title]="'PREVIEW' | translate" target="_blank"
             href="{{ settings.absolute_uri }}?preview-template={{ getThemeViewing().name }}">
            <fa-icon [fixedWidth]="true" [icon]="faEye"></fa-icon>
          </a>
          <!-- Select button -->
          <button class="btn btn-primary" type="button" translate (click)="setTemplate()"
                  [disabled]="themeLoading || getThemeViewing().name === templateConfig.name">
            SELECT
          </button>
        </div>
        <!-- Theme author -->
        <div class="text-secondary" [title]="'AUTHOR' | translate">{{ getThemeViewing().config.author }}</div>
      </div>
      <!-- Themes -->
      <div class="border-top border-bottom">
        <carousel [interval]="0" *ngIf="templates" [noWrap]="false" #themeCarousel>
          <slide *ngFor="let template of templates">
            <img [src]="template.media.thumbnail_512x512" *ngIf="template.media.thumbnail_512x512" width="100%">
          </slide>
        </carousel>
      </div>
      <!-- Body -->
      <div class="card-body">
        <!-- Template primary color -->
        <div class="form-group">
          <label for="template_primary_color" translate>TEMPLATE_PRIMARY_COLOR</label>
          <div class="input-group">
            <select class="custom-select" formControlName="template_primary_color" id="template_primary_color">
              <option *ngFor="let color of templatePrimaryColors" [ngValue]="color.id">{{ color.label }}</option>
            </select>
            <!-- Selected color -->
            <div class="input-group-append px-4 rounded-right"
                 [ngStyle]="{'background-color': getCurrentPrimaryColor()}">
            </div>
          </div>
        </div>
        <!-- Code Highlight -->
        <div class="form-group mb-0">
          <label for="highlight_theme" translate>CODE_HIGHLIGHT</label>
          <div class="input-group">
            <select class="custom-select" formControlName="highlight_theme" id="highlight_theme">
              <option *ngFor="let theme of highlightThemes" [ngValue]="theme.id">{{ theme.label }}</option>
            </select>
          </div>
        </div>
      </div>
      <!-- Footer -->
      <div class="card-footer text-right">
        <!-- Submit -->
        <button class="btn btn-primary" [disabled]="themeLoading" translate>SAVE_CHANGES</button>
      </div>
    </form>

    <!-- Template config (theme options) -->
    <div class="card dash mb-3">
      <!-- Header -->
      <div class="card-header" translate>THEME_OPTIONS</div>
      <!-- Body -->
      <div class="card-body" *ngIf="templateConfig">
        <!-- Fields -->
        <div class="form-group" *ngFor="let field of templateConfig.fields | keyvalue">
          <!-- Boolean field (switch/checkbox) -->
          <div *ngIf="field.value.type === 'boolean'" class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" [id]="field.key" [(ngModel)]="field.value.value">
            <label class="custom-control-label" [for]="field.key">{{ field.value.verbose_name }}</label>
            <small class="form-text text-muted">{{ field.value.help_text }}</small>
          </div>
        </div>
      </div>
      <!-- Footer -->
      <div class="card-footer text-right" (click)="updateTemplateConfig()">
        <!-- Submit -->
        <button class="btn btn-primary" [disabled]="templateConfigLoading" translate>SAVE_CHANGES</button>
      </div>
    </div>
  </div>
</div>

<!-- File list modal -->
<ng-template #fileListModalTemplate>
  <div class="modal-header">
    <h5 class="modal-title pull-left" translate>SELECT_IMAGE</h5>
    <button type="button" class="close pull-right" aria-label="Close" (click)="fileListModalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <app-file-list [selection]="true"
                   [selected]="getSelectingForSelected()"
                   (choose)="onFileSelect($event)">
    </app-file-list>
  </div>
</ng-template>
