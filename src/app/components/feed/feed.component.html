<div class="container">
  <div class="row" infiniteScroll [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
       (scrolled)="loadMore(next)">

    <!-- Left -->
    <div class="col-lg-3">

      <!-- Main navs -->
      <div class="nav flex-column nav-pills my-3">
        <a class="nav-link"
           *ngFor="let nav of mainNavs"
           [routerLink]="['/', nav.route]"
           [ngClass]="{'active shadow-sm': nav === navSelected}">
          <fa-icon [fixedWidth]="true" [icon]="nav.icon"></fa-icon>
          <span class="ml-2" translate>{{ nav.label }}</span>
        </a>
      </div>

      <!-- Tag navs title -->
      <div class="font-weight-bold small text-secondary pl-3 mt-5" translate>POPULAR_TAGS</div>

      <!-- Tag navs -->
      <div class="nav flex-column nav-pills my-3 small">
        <a class="nav-link" *ngFor="let nav of tagNavs" (click)="selectTag($event)">
          <fa-icon [fixedWidth]="true" icon="hashtag"></fa-icon>
          <span class="ml-2">{{ nav }}</span>
        </a>
      </div>
    </div>

    <!-- Middle -->
    <div class="col-lg-6" *ngIf="entries">

      <!-- Post -->
      <div class="card shadow-sm my-3" *ngFor="let entry of entries">

        <!-- Header -->
        <div class="card-header d-flex">

          <!-- Logo -->
          <img [src]="entry.site.media.logo.thumbnail_48x48" *ngIf="entry.site.media.logo" class="rounded-circle mr-3">
          <img *ngIf="!entry.site.media.logo" class="rounded-circle mr-3">

          <!-- Title and time since -->
          <div class="d-flex flex-column">
            <b>{{ entry.site.title }}</b>
            <small>{{ entry.published | date }}</small>
          </div>

          <!-- Featured -->
          <div class="d-flex flex-column ml-auto justify-content-center text-warning"
               [tooltip]="'FEATURED' | translate" placement="left" delay="250" *ngIf="entry.featured">
            <fa-icon [icon]="['fas', 'star']"></fa-icon>
          </div>
        </div>

        <!-- Cover image -->
        <div class="card-body cover" *ngIf="entry.media.cover_image"
             [style.background-image]="getBackgroundImage(entry.media.cover_image.file)"></div>

        <!-- Body -->
        <div class="card-body">

          <!-- Title -->
          <h5 class="card-title"><a [routerLink]="['/', 'entry', entry.id]">{{ entry.title }}</a></h5>

          <!-- Excerpt -->
          <p class="card-text">{{ entry.excerpt }}</p>
        </div>

        <!-- Footer -->
        <div class="card-footer">

          <!-- Like -->
          <button class="btn btn-link" (click)="like(entry)">
            <fa-icon [fixedWidth]="true" [icon]="['far', 'heart']" *ngIf="!entry.is_voted"></fa-icon>
            <fa-icon [fixedWidth]="true" [icon]="['fas', 'heart']" *ngIf="entry.is_voted" class="text-danger"></fa-icon>
            <span *ngIf="entry.vote_count">{{ entry.vote_count }}</span>
          </button>

          <!-- Views -->
          <button class="btn btn-link" *ngIf="entry.view_count">
            <fa-icon [fixedWidth]="true" [icon]="['far', 'eye']"></fa-icon>
            <span>{{ entry.view_count }}</span>
          </button>

          <!-- Comments -->
          <button class="btn btn-link">
            <fa-icon [fixedWidth]="true" [icon]="['far', 'comment']"></fa-icon>
            <span *ngIf="entry.active_comment_count">{{ entry.active_comment_count }}</span>
          </button>

          <!-- Bookmark -->
          <button class="btn btn-link float-right" (click)="bookmark(entry)">
            <fa-icon [fixedWidth]="true" [icon]="['far', 'bookmark']" *ngIf="!entry.is_bookmarked"></fa-icon>
            <fa-icon [fixedWidth]="true" [icon]="['fas', 'bookmark']" *ngIf="entry.is_bookmarked"></fa-icon>
          </button>

          <!-- Share -->
          <ng-template #shareTemplate>
            <app-entry-share [url]="entry.absolute_uri"></app-entry-share>
          </ng-template>
          <button class="btn btn-link float-right" [popover]="shareTemplate"
                  popoverTitle="Share" placement="left" [outsideClick]="true">
            <fa-icon [fixedWidth]="true" [icon]="['far', 'share-square']"></fa-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
